<link rel="stylesheet" href="/assets/blue/style.css" type="text/css" id="" media="print, projection, screen">
<!--<link rel="stylesheet" href="/assets/navpager.css" type="text/css">-->
<link rel="stylesheet" href="/assets/jquery.tablesorter.pager.css" type="text/css">

<script type="text/javascript" src="/assets/jquery-latest.js"></script>
<script type="text/javascript" src="/assets/jquery.tablesorter.js"></script>
<script type="text/javascript" src="/assets/jquery.tablesorter.pager.js"></script>
<script type="text/javascript" id="js">$(document).ready(function() {
    // call the tablesorter plugin
    $("table").tablesorter({
        // change the multi sort key from the default shift to alt button
        sortMultiSortKey: 'altKey'
    });
});
</script>
<script type="text/javascript">
    $(function() {
        $("table")
                .tablesorterPager({container: $("#pager")});
    });
</script>
<div id="applicant-detail">
  <table class="tablesorter" id="TheTable" border="1" style="width: 800px;margin: 0 auto 0 auto">
    <thead>
    <th>SN</th>
    <th>Name</th>

    <% if params['term'] == '2' %>
    <th>T1 GPA</th>
    <th>T1 Rank</th>
    <th>T1 Fail</th>
    <th>Y1 GPA</th>
    <th>Y1 FAIL<th>
     <% end %>
    <th>LT</th>
    <th>GPA </th>
    <th>Rank </th>
    <th>Fail </th>
    <th>Scholar </th>
    </thead>
    <% @applicants.each do |applicant| %>
        <% if applicant.present? %>
            <tr>
              <td style="width: 140px;text-align: center;"><%= applicant.number %></td>
              <td style="width: 280px;"><%=  link_to applicant.name, applicant,:target => 'new'     %></td>
              <!--<td><%= applicant.cohort %></td>-->
              <% if params['term'] == '2' %>

                  <td> <%=$gpa = Student.where(name: applicant.name , cohort: applicant.cohort ,term: '1' ).last.try(:gpa) %></td>
                  <td> <%= Student.where(name: applicant.name , cohort: applicant.cohort ,term: '1' ).last.try(:rank) %></td>
                  <td> <%=$fail = Student.where(name: applicant.name , cohort: applicant.cohort ,term: '1' ).last.try(:fail) %></td>
                  <!--get term 1 ID-->
                  <% $past_id=Student.where(name: applicant.name , cohort: applicant.cohort ,term: '1' ).last.try(:id); %>
                  <!--now get the Units-->
                  <% @get_unit=Grade.where(student_id: $past_id) %>
                  <% $total=0; %>
                  <% @get_unit.each do |grades| %>
                      <% if grades.grade.present? and !(['Pass', 'Fail'].include?(grades.grade)) %>
                          <% $total = $total + grades.units.to_f %>
                      <% end %>
                  <% end %>
                  <% $tgpa = ($gpa.to_f * $total) + (applicant.gpa.to_f * $total ) %>
                  <%$gg = $tgpa / ($total * 2 ) %>
                  <td><%=number_with_precision($gg, precision: 2)%></td>
                  <td><%= $fail.to_i + applicant.fail.to_i %></td>
              <% end  %>
              <td style="width: 50px;text-align: center;"><%= applicant.learning_team %></td>
              <!--end of term 2-->

              <td style="width: 60px;text-align: center;"><%= applicant.gpa %></td>
              <td style="width: 50px;text-align: center;"><%= applicant.rank %></td>
              <td style="width: 50px;text-align: center;"><%= applicant.fail %></td>
              <td style="width: 65px;text-align: center;"><%= applicant.scholar %></td>
            </tr>
        <% end %>
    <% end %>
  </table>
  <div id="pager" class="pager" style="margin-top: 80px;margin-left: 385px;" >
    <form>
      <img src="/assets/addons/first.png" class="first">
      <img src="/assets/addons/prev.png" class="prev">
      <input type="text" class="pagedisplay">
      <img src="/assets/addons/next.png" class="next">
      <img src="/assets/addons/last.png" class="last">
      <select class="pagesize" style="width: 80px;">
        <option selected="selected" value="10">10</option>
        <option value="100">100</option>
        <option value="50">50</option>
        <option value="30">30</option>
        <option value="20">20</option>
        <option value="15">15</option>
        <option value="13">13</option>
        <option value="10">10</option>
        <option value="7">7</option>
        <option value="5">5</option>
        <option value="3">3</option>
      </select>
    </form>
  </div>
</div>